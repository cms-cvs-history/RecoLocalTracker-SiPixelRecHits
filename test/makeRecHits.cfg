process ProcessPixelRecHits = {

  untracked PSet maxEvents = {untracked int32 input = 100}

  source = PoolSource { 
          # untracked vstring fileNames    = {'file:/localscratch/danek/data/digis_tk_090pre3.root'}
          untracked vstring fileNames = {'file:Muon_FullValidation_180pre5.root'}

          #untracked int32 maxEvents      = 100
          untracked uint32 debugVebosity = 10
          untracked bool   debugFlag     = true
  }

  # Initialize magnetic field
  include "MagneticField/Engine/data/volumeBasedMagneticField.cfi"

  # Tracker SimGeometryXML
  include "Geometry/TrackerSimData/data/trackerSimGeometryXML.cfi"

  # Tracker Geometry Builder
  include "Geometry/TrackerGeometryBuilder/data/trackerGeometry.cfi"

  # Tracker Numbering Builder
  include "Geometry/TrackerNumberingBuilder/data/trackerNumberingGeometry.cfi"

  service = MessageLogger {
     untracked vstring destinations    = { "debugmessages.txt" }
     untracked PSet debugmessages.txt  = { untracked string threshold = "DEBUG"}
     untracked vstring debugModules    = { "siPixelRecHits"}
   } 

########################################################################
#
# Run Pixel Clusterizer and RecHit producer in chain
#
include "CalibTracker/SiPixelESProducers/data/SiPixelFakeGainESSource.cfi"
include "RecoLocalTracker/SiPixelClusterizer/data/SiPixelClusterizer.cfi"
#
include "RecoLocalTracker/SiPixelRecHits/data/SiPixelRecHits.cfi"
########################################################################
	
	#
  	# Calibrations from DB
  	#
	es_source = PoolDBESSource { 
		VPSet toGet = {{ string record = "SiPixelLorentzAngleRcd" string tag = "trivial_la" }}
		
		string connect = "sqlite_file:prova2.db"    
// 		untracked string catalog = "file:langle.xml"
		string timetype = "runnumber" 
		PSet DBParameters = {
			untracked string authenticationPath="/afs/cern.ch/cms/DB/conddb"
			untracked int32 messageLevel=2
// 			untracked bool loadBlobStreamer = true
		}
    }
	
	#
	# Calibrations from fake ESSource (generated at run-time)
	#
	include "CalibTracker/SiPixelESProducers/data/SiPixelFakeLorentzAngleESSource.cfi"
	#
	# Choose which ES source you prefer...
	#
	es_prefer = SiPixelFakeLorentzAngleESSource{ }
// 	es_prefer = PoolDBESSource{ }
  
# to store the output
module out = PoolOutputModule {
           untracked string fileName = 'pixRecHits.root'
}

  module ReadLocalMeasurement =  ReadPixelRecHit{
        untracked bool Verbosity = true
        InputTag src = siPixelRecHits
  }

path p = {siPixelClusters,
          siPixelRecHits,
          ReadLocalMeasurement
          }
endpath outpath = { out }

#path p = {siPixelClusters, 
#          siPixelRecHits,
#	  ReadLocalMeasurement}

}
