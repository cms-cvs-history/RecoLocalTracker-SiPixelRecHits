process ProcessPixelRecHits = {

  # untracked PSet maxEvents = {untracked int32 input = 10}

  source = PoolSource { 
          # untracked vstring fileNames    = {'file:/localscratch/danek/data/digis_tk_090pre3.root'}
          untracked vstring fileNames = {'file:/scratch/dkotlins/Muon_FullValidation_180pre5.root'}

          untracked uint32 debugVebosity = 10
          untracked bool   debugFlag     = true
  }


  # Initialize magnetic field
  include "MagneticField/Engine/data/volumeBasedMagneticField.cfi"

  # Tracker SimGeometryXML
  include "Geometry/TrackerSimData/data/trackerSimGeometryXML.cfi"

  # Tracker Geometry Builder
  include "Geometry/TrackerGeometryBuilder/data/trackerGeometry.cfi"

  # Tracker Numbering Builder
  include "Geometry/TrackerNumberingBuilder/data/trackerNumberingGeometry.cfi"

  service = MessageLogger {
     untracked vstring destinations    = { "debugmessages.txt" }
     untracked PSet debugmessages.txt  = { untracked string threshold = "DEBUG"}
     untracked vstring debugModules    = { "siPixelRecHits"}
   } 

########################################################################
#
# Run Pixel Clusterizer and RecHit producer in chain
#
include "CalibTracker/SiPixelESProducers/data/SiPixelFakeGainESSource.cfi"
include "RecoLocalTracker/SiPixelClusterizer/data/SiPixelClusterizer.cfi"
#
include "RecoLocalTracker/SiPixelRecHits/data/SiPixelRecHits.cfi"
########################################################################
	
# to avoid the "missing prova2.db problem"
 include "CalibTracker/Configuration/data/Tracker_FakeConditions.cff" 

# comment out to avoid the prova2 problem? d.k. 13/02/08
	#
  	# Calibrations from DB
  	#
#	es_source = PoolDBESSource { 
#		VPSet toGet = {{ string record = "SiPixelLorentzAngleRcd" string tag = "trivial_la" }}
#		
#		string connect = "sqlite_file:prova2.db"    
#// 		untracked string catalog = "file:langle.xml"
#		string timetype = "runnumber" 
#		PSet DBParameters = {
#			untracked string authenticationPath="/afs/cern.ch/cms/DB/conddb"
#			untracked int32 messageLevel=2
#// 			untracked bool loadBlobStreamer = true
#		}
#    }
	
	#

	# Calibrations from fake ESSource (generated at run-time)
	#
	include "CalibTracker/SiPixelESProducers/data/SiPixelFakeLorentzAngleESSource.cfi"
	#
	# Choose which ES source you prefer...
	#
	es_prefer = SiPixelFakeLorentzAngleESSource{ }
// 	es_prefer = PoolDBESSource{ }
  
# to store the output
module out = PoolOutputModule {
           untracked string fileName = 'pixRecHits.root'
}

 # a service to use root histos
  service = TFileService {
    string fileName = "histo.root"
  }

  module PixRecHits =  ReadPixelRecHit{
        untracked bool Verbosity = false
        InputTag src = siPixelRecHits
  }

path p = {siPixelClusters,
          siPixelRecHits,
          PixRecHits
          }

# endpath outpath = { out }

}
