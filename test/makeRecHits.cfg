process ProcessPixelRecHits = {

  untracked PSet maxEvents = {untracked int32 input = 100}

  source = PoolSource { 
          # untracked vstring fileNames    = {'file:/localscratch/danek/data/digis_tk_090pre3.root'}
          untracked vstring fileNames = {'file:Muon_FullValidation.root'}

          #untracked int32 maxEvents      = 100
          untracked uint32 debugVebosity = 10
          untracked bool   debugFlag     = true
  }

  # Initialize magnetic field
  include "MagneticField/Engine/data/volumeBasedMagneticField.cfi"

  # Tracker SimGeometryXML
  include "Geometry/TrackerSimData/data/trackerSimGeometryXML.cfi"

  # Tracker Geometry Builder
  include "Geometry/TrackerGeometryBuilder/data/trackerGeometry.cfi"

  # Tracker Numbering Builder
  include "Geometry/TrackerNumberingBuilder/data/trackerNumberingGeometry.cfi"

  service = MessageLogger {
     untracked vstring destinations    = { "debugmessages.txt" }
     untracked PSet debugmessages.txt  = { untracked string threshold = "DEBUG"}
     untracked vstring debugModules    = { "siPixelRecHits"}
   } 

########################################################################
#
# Run Pixel Clusterizer and RecHit producer in chain
#
include "CalibTracker/SiPixelESProducers/data/SiPixelFakeGainESSource.cfi"
include "RecoLocalTracker/SiPixelClusterizer/data/SiPixelClusterizer.cfi"
#
include "RecoLocalTracker/SiPixelRecHits/data/SiPixelRecHits.cfi"
########################################################################

# to store the output
module out = PoolOutputModule {
           untracked string fileName = 'pixRecHits.root'
}

  module ReadLocalMeasurement =  ReadPixelRecHit{
        untracked bool Verbosity = true
        InputTag src = siPixelRecHits
  }

path p = {siPixelClusters, 
          siPixelRecHits,
          ReadLocalMeasurement
          }
endpath outpath = { out }

#path p = {siPixelClusters, 
#          siPixelRecHits,
#	  ReadLocalMeasurement}

}
